# connectSix_AI
### 吉林大学2021级数据结构课程设计
题目：赛道B——六子棋编程对抗赛（详见“[2023-Track AB题目.pdf](https://github.com/wulixinlaimujijia/connectSix_AI/blob/ba052bcb4b66ae910f641e332dfba1e29c04ba88/2023-Track%20AB%E9%A2%98%E7%9B%AE.pdf)”）  

参考文献：详见“[参考资料](https://github.com/wulixinlaimujijia/connectSix_AI/tree/ba052bcb4b66ae910f641e332dfba1e29c04ba88/%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99)”

## 设计思路
### 1 确定战局边界
在双方对弈的过程中，战局一般仅占据整个棋盘的一个部分（在前半局尤为明显），可见，有些相距战局较远的点是毫无价值的，因此在寻找可行棋步之前便可先将这些点排除在外。  
  
此外，在对可行棋步进行评估时，也仅需考虑边界内的点即可。  
  
在还原棋盘的同时找出处于边界的点，可以省下后面为找出战局边界而特意扫描棋盘的时间。  
  
如此一来，在还原完棋盘时，便确定了战局的四个边界。  
  
此时若是第一回合，黑棋则直接输出棋盘的中间位置，白棋则将边界扩展一格（若有战局边界为棋盘边界则不扩展）。  
  
此时若不是第一回合，则一律扩展两格（若有战局边界距棋盘边界仅0-1格，则扩展至棋盘边界）。  
  
综上，便成功确定了战局边界。

### 2 寻找可行棋步
即使在缩小范围后，所得到的合法棋步大大减少，但要在极其有限的时间内完成对这些合法棋步的全部搜索也是难以实现的，因此，限制搜索宽度，即从所有合法棋步中选择出一些较为重要的可行棋步是有必要的。  
  
在确定战局边界后便扫描战局内的各个点位，并对空点位进行评分，将各个点位按评分从大到小的顺序进行排列，以使Alpha-Beta剪枝能尽可能地发挥功效。  
  
在这一次的评分中，我们对各空点位的八个方向使用基于“路”的扫描。  
  
由于这次扫描的目的是求出各点位的重要性，所以应当将我方路的价值与对手路的威胁值相加，以此得到该空点位的评分，评分越高说明该点位价值越大。  
  
将我方路的价值与对手路的威胁值相加的原因是，我方路的价值代表的是这条路对我们进攻的重要性，路的价值越大，进攻所能得到的利益越大；敌方路的威胁值代表这条路对我们防御的重要性，路的威胁越大，说明越要阻挡对方的进攻，即防御所能得到的利益越大。因此将二者相加，便可得到体现该合法棋步重要性的评分。  
  
扫描完战局后，便得到了评分由大到小排列的合法棋步，其中在宽度限制范围内的棋步极为之后用于搜索的可行棋步。

### 3 Alpha-Beta剪枝
由于单纯使用极大值极小值搜索，会带来许多冗余的搜索，而这些搜索是毫无价值的，可以通过确定上下界的形式，先一步将毫无价值的搜索结点删去，即Alpha-Beta剪枝操作。

同时为了简化代码，基于负极大值算法编写了Alpha-Beta剪枝算法。

在得到可行棋步后便调用基于负极大值算法的Alpha-Beta剪枝函数。

在递归达到最大深度时，调用评估函数对当前战局进行评估。

若尚未达到最大递归深度，则进行模拟落子。外循环模拟第一颗落子，内循环模拟第二颗落子。

在第二颗落子后再次调用Alpha-Beta剪枝函数直到最大递归深度。

由评估函数得到评估值与alpha、beta值进行比较，若大于等于beta，则进行beta剪枝，即撤回两颗落子并直接返回beta，若大于alpha，则更新alpha，并撤回第二颗落子，且此时若是第一层递归，则同时更新最佳棋步。

### 4 评估函数
在评估函数中，依次对模拟落下的几颗子进行基于“路”的扫描。

由于每个落子只会对以其位置为中心的四个方向的价值产生影响，因此，只需要对落子进行局部扫描即可得到当前局面的评估值。

同时，由于我们价值代表的是当前局面对我方的利益，价值越大则局面对我方越有利；而对方威胁值代表的是当前局面对我方的威胁，威胁值越大则局面对我方越不利。

因此将我方价值减去对手威胁值，即为当前局面的价值。

而落子后局面的价值减去落子前局面的价值，即为各落子总价值。最后将各落子总价值相加，便得到当前走法的总价值，总价值越大，则对当前执棋方越有利。

## 改进
虽然使用了启发式的Alpha-Beta剪枝搜索，但在搜索速度上只能说是差强人意，甚至有时会下出自杀式的棋步。  

理论上若是合理使用置换表技术，AI的搜索速度能够再上一个台阶，实力能够达到新的层次。  

此外，还可以通过遗传算法等机器学习技术迭代出更为合理的评估值。
